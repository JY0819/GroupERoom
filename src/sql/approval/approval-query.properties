#documentNumCall
selectForm = SELECT DISTINCT MANAGEEMPID, (SELECT DISTINCT LAST_VALUE(MANAGEDOCNO) OVER (ORDER BY MANAGEDOCNO ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS MANAGEDOCNO FROM MANAGEDOC) AS MANAGEDOCNO, (SELECT DISTINCT LAST_VALUE(MANAGENO) OVER (ORDER BY MANAGENO ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS MANAGENO FROM MANAGEDOC) AS MANAGENO FROM MANAGEDOC WHERE MANAGEEMPID = ?
#dept select
selectDept = SELECT D.DEPTNAME, COUNT(E.EMPNAME) FROM EMP E JOIN LOGOFCHANGEDEPT L ON(E.EMPID = L.EMPID) JOIN DEPT D ON(L.DEPTID = D.DEPTID) GROUP BY DEPTNAME ORDER BY D.DEPTNAME ASC
#emp select
selectEmp = SELECT E.EMPID, E.EMPNAME FROM EMP E JOIN LOGOFCHANGEDEPT L ON(E.EMPID = L.EMPID) JOIN DEPT D ON(L.DEPTID = D.DEPTID) ORDER BY D.DEPTNAME ASC
#attachments insert
insertAttachments = INSERT INTO ATTACHMENTS VALUES(?, ?, ?, ?, SYSDATE, 'N')
#doc insert
insertDoc = INSERT INTO DOC VALUES((SELECT DISTINCT LAST_VALUE(APPRNO) OVER (ORDER BY APPRNO ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS APPRNO FROM APPR), (SELECT MANAGEDOCNO+1 FROM MANAGEDOC WHERE MANAGEEMPID=? AND MANAGEDOCNO=?),(SELECT DISTINCT DEPTID FROM LOGOFCHANGEDEPT L JOIN MANAGEDOC M ON(L.EMPID = M.MANAGEEMPID) WHERE M.MANAGEEMPID=?))
#appr insert
insertAppr = INSERT INTO APPR VALUES(SEQ_APPR.NEXTVAL, ?, (SELECT DISTINCT L.DEPTID FROM LOGOFCHANGEDEPT L JOIN MANAGEDOC M ON(L.EMPID = M.MANAGEEMPID) WHERE M.MANAGEEMPID=?), ?, DEFAULT, DEFAULT, DEFAULT, DEFAULT)
#manageDoc insert
insertDocument = INSERT INTO MANAGEDOC VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
#apprLine insert
insertApprLine = INSERT INTO APPRLINE VALUES(((SELECT EMPID FROM EMP E WHERE EMPID = (SELECT DISTINCT MANAGEEMPID FROM MANAGEDOC WHERE MANAGEEMPID = ?))), ?, (SELECT DISTINCT LAST_VALUE(APPRNO) OVER (ORDER BY APPRNO ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS APPRNO FROM APPR))
#document selectList
selectList = SELECT DISTINCT E.EMPID, E.EMPNAME, D.DEPTNAME, M.MANAGEDOCNO, M.MANAGETITLE, M.MANAGEDAY FROM EMP E JOIN LOGOFCHANGEDEPT L ON(E.EMPID = L.EMPID) JOIN DEPT D ON(D.DEPTID = L.DEPTID) JOIN MANAGEDOC M ON(E.EMPID = M.MANAGEEMPID) JOIN APPRLINE A ON(E.EMPID = A.APPREMPID) ORDER BY M.MANAGEDOCNO;